version: 2
jobs:
  build:
    macos:
      xcode: '10.0.0'
    environment:
      LANG: en_US.UTF-8
      LC_ALL: en_US.UTF-8
      GEM_HOME: .gem
      GEM_PATH: .gem
    steps:
    - checkout
    - run: xcrun simctl list
    - run: gem install fastlane --no-rdoc --no-ri --no-document
    - run: echo 'export PATH=$GEM_PATH:$PATH' >> $BASH_ENV
    - run: make test_macOS
    - run: make test_tvOS
    - run: make test_iOS
    - run: make test_iOS_9
    - run: make test_macOS_report
    - run: make test_tvOS_report
    - run: make test_iOS_report
    - store_test_results:
        path: test_reports
